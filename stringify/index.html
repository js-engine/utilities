<!DOCTYPE html>
<html>
  <head>
    <title>Stringify Circular Structures</title>
    <style type="text/css">
      body{
        font-family: Verdana;
      }
      .snippet{
        width: 560px;
        height: 410px;
        font-size: 11px;
        font-family: Verdana;
        outline: none;
        resize: none;
        border:2px solid #000;
        padding: 11px;
      }
      h4{
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <h1>Stringify Circular Structures in JavaScript</h1>
    <h2>Code snippet:</h2>
    <textarea readonly="readonly" class="snippet">
      function getJSON(obj) {
          var str = JSON.stringify(obj, function(key, value) {
              if (typeof value === "object") {
                  if (!value["_[isAlreadyProcessed]_"]) {
                      value["_[isAlreadyProcessed]_"] = true;
                      return value;
                  } else {
                      return "[.....circRef.Key.....]";
                  }
              } else {
                  return value;
              }
          });
          var _obj = JSON.parse(str);
          return JSON.stringify(_obj, function(key, value) {
              if (typeof value === "object") {
                  Object.getOwnPropertyNames(value).forEach(function(k) {
                      if (value[k] === "[.....circRef.Key.....]") {
                          delete value[k];
                      }
                  });
                  if (value["_[isAlreadyProcessed]_"]) {
                      delete value["_[isAlreadyProcessed]_"];
                  }
                  return value;
              } else {
                  return value;
              }
          });
      }
    </textarea>
    <h3>Usage:</h3>
    getJSON(&lt;object_to_be_stringified&gt;);
    <h4>
      Note:
      <br/>This function omits the keys in the result that have circular reference.
      <br/>It modifies the original input object.
      <br/>
      <br/>If you want the original object to stay intact, use getJSON(_.cloneDeep(&lt;object_to_be_stringified&gt;));
      <br/>/* _.cloneDeep is available from lodash library */
    </h4>
  </body>
</html>
